{% extends "base.html" %}
{% block title %}Admin Dashboard - semblnyce{% endblock %}
{% block content %}
<h1 style="text-align: center; margin-bottom: 40px;">ADMIN DASHBOARD</h1>

<div class="admin-stats">
    <div class="stat-card">
        <div class="stat-label">TODAY'S VIEWS</div>
        <div class="stat-value">{{ today_views }}</div>
    </div>

    <div class="stat-card">
        <div class="stat-label">UNIQUE VISITORS</div>
        <div class="stat-value">{{ unique_visitors }}</div>
    </div>

    <div class="stat-card">
        <div class="stat-label">RETURNING USERS</div>
        <div class="stat-value">{{ returning_users }}</div>
    </div>

    <div class="stat-card">
        <div class="stat-label">TOTAL ORDERS</div>
        <div class="stat-value">{{ total_orders }}</div>
    </div>

    <div class="stat-card">
        <div class="stat-label">TOTAL REVENUE</div>
        <div class="stat-value">${{ "%.2f"|format(total_revenue) }}</div>
    </div>

    <div class="stat-card">
        <div class="stat-label">TOTAL PAGE VIEWS</div>
        <div class="stat-value">{{ view_data.total }}</div>
    </div>
</div>

<div class="admin-section">
    <h2>Quick Actions</h2>
    <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-top: 20px;">
        <a href="/admin/orders" class="btn">VIEW ALL ORDERS</a>
        <a href="/admin/contacts" class="btn btn-secondary">VIEW CONTACT SUBMISSIONS</a>
    </div>
</div>

<div class="admin-section">
    <h2>Recent Orders</h2>
    {% if recent_orders %}
    <table class="admin-table">
        <thead>
            <tr>
                <th>Order ID</th>
                <th>Customer</th>
                <th>Items</th>
                <th>Total</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
            {% for order in recent_orders %}
            <tr>
                <td>{{ order.id[:8] }}...</td>
                <td>{{ order.customer_email or 'Unknown' }}</td>
                <td>
                    {% for item in order.items %}
                        {{ item.name }} ({{ item.size }}) x{{ item.quantity }}{% if not loop.last %}<br>{% endif %}
                    {% endfor %}
                </td>
                <td>${{ "%.2f"|format(order.total) }}</td>
                <td>{{ order.timestamp[:10] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>No orders yet.</p>
    {% endif %}
</div>

<div class="admin-section">
    <h2>Page View Breakdown</h2>
    <table class="admin-table">
        <thead>
            <tr>
                <th>Page</th>
                <th>Views</th>
                <th>Percentage</th>
            </tr>
        </thead>
        <tbody>
            {% for page, count in view_data.pages.items() %}
            <tr>
                <td style="text-transform: capitalize;">{{ page.replace('_', ' ') }}</td>
                <td>{{ count }}</td>
                <td>{{ "%.1f"|format((count / view_data.total * 100) if view_data.total > 0 else 0) }}%</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}